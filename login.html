<!DOCTYPE html>
<html>
	<head>
	  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	  <meta name="renderer" content="webkit">
	  <title>登录</title>
	  <link href="css/bootstrap.min.css" rel="stylesheet">
		
	  <link href="themes/css/style.css" rel="stylesheet" /> 
	  <link href="themes/blue/core.css" id="bjui-link-theme" rel="stylesheet" /> 
	  <link href="themes/css/fontsize.css" id="bjui-link-theme" rel="stylesheet" /> 
	  <!-- plug - css --> 
	  <link href="plugins/kindeditor_4.1.11/themes/default/default.css" rel="stylesheet" /> 
	  <link href="plugins/colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet" /> 
	  <link href="plugins/nice-validator-1.0.7/jquery.validator.css" rel="stylesheet" /> 
	  <link href="plugins/bootstrapSelect/bootstrap-select.css" rel="stylesheet" /> 
	  <link href="plugins/webuploader/webuploader.css" rel="stylesheet" /> 
	  <link href="themes/css/FA/css/font-awesome.min.css" rel="stylesheet" /> 
	  <!-- Favicons --> 
	  <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-precomposed.png" /> 
	  <link rel="shortcut icon" href="assets/ico/favicon.png" /> 
	  
	  <link href="plugins/uploadify/css/uploadify.css" rel="stylesheet" /> 
	  
	  <link href="themes/css/bootstrap.css" rel="stylesheet">
	<!-- core - css -->
	<link href="themes/css/style.css" rel="stylesheet">
	<link href="themes/blue/core.css" id="bjui-link-theme" rel="stylesheet">
	<link href="themes/css/fontsize.css" id="bjui-link-theme" rel="stylesheet">
	<!-- plug - css -->
	<link href="plugins/kindeditor_4.1.11/themes/default/default.css" rel="stylesheet">
	<link href="plugins/colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet">
	<link href="plugins/nice-validator-1.0.7/jquery.validator.css" rel="stylesheet">
	<link href="plugins/bootstrapSelect/bootstrap-select.css" rel="stylesheet">
	<link href="plugins/webuploader/webuploader.css" rel="stylesheet">
	<link href="themes/css/FA/css/font-awesome.min.css" rel="stylesheet">
	<!-- Favicons -->
	<link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-precomposed.png">
	<link rel="shortcut icon" href="assets/ico/favicon.png">
	<!--[if lte IE 7]>
	<link href="themes/css/ie7.css" rel="stylesheet">
	<![endif]-->
	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lte IE 9]>
	    <script src="other/html5shiv.min.js"></script>
	    <script src="other/respond.min.js"></script>
	<![endif]-->
	<!-- jquery -->
	
	<script src="js/jquery-1.11.3.min.js"></script>
	<script src="js/jquery.cookie.js"></script>

	<script src="js/jquery.form.js"></script>
	
	<!--[if lte IE 9]>
	<script src="other/jquery.iframe-transport.js"></script>
	<![endif]-->
	<!-- B-JUI -->
	<script src="js/bjui-all.min.js"></script>
	<!-- plugins -->
	<!-- swfupload for kindeditor -->
	<script src="plugins/swfupload/swfupload.js"></script>
	<!-- Webuploader -->
	<script src="plugins/webuploader/webuploader.js"></script>
	<!-- kindeditor -->
	<script src="plugins/kindeditor_4.1.11/kindeditor-all-min.js"></script>
	<script src="plugins/kindeditor_4.1.11/lang/zh-CN.js"></script>
	<!-- colorpicker -->
	<script src="plugins/colorpicker/js/bootstrap-colorpicker.min.js"></script>
	<!-- ztree -->
	<script src="plugins/ztree/jquery.ztree.all-3.5.js"></script>
	<!-- nice validate -->
	<script src="plugins/nice-validator-1.0.7/jquery.validator.js"></script>
	<script src="plugins/nice-validator-1.0.7/jquery.validator.themes.js"></script>
	<!-- bootstrap plugins -->
	<script src="plugins/bootstrap.min.js"></script>
	<script src="plugins/bootstrapSelect/bootstrap-select.min.js"></script>
	<script src="plugins/bootstrapSelect/defaults-zh_CN.min.js"></script>
	<!-- icheck -->
	<script src="plugins/icheck/icheck.min.js"></script>
	<!-- HighCharts -->
	<script src="plugins/highcharts/highcharts.js"></script>
	<script src="plugins/highcharts/highcharts-3d.js"></script>
	<script src="plugins/highcharts/themes/gray.js"></script>
	<!-- other plugins -->
	<script src="plugins/other/jquery.autosize.js"></script>
	<link href="plugins/uploadify/css/uploadify.css" rel="stylesheet">
	<script src="plugins/uploadify/scripts/jquery.uploadify.min.js"></script>
	<script src="plugins/download/jquery.fileDownload.js"></script>

  	<script src="js/global.js" type="text/javascript"></script>
	<script src="js/interfaceServer.js" type="text/javascript"></script>
	<script src="js/httpService.js" type="text/javascript"></script>
  	<script src="js/pushService.js" type="text/javascript"></script>

		<style type="text/css">
			body{
				font-family: "Verdana", "Tahoma", "Lucida Grande", "Microsoft YaHei", "Hiragino Sans GB";
				background: url(img/bb44e221a7e50cc13528bdd51f58b76c.jpg) no-repeat;
				background-size: 100% 100%;
			}
			.main{
				position: absolute;
				width: 400px;
				left: 50%;
				top: 50%;
				background: rgba(255,255,255,0.5);
				background-color: lightblue\0;
				background: #fff;
				border-radius: 6px;
				margin-left: -200px;
				margin-top: -145px;
			}
			#login{
			    padding: 0px 8px 45px;
			    height: 200px;
			}
			.logo img{
				vertical-align: middle;
				margin: 0 auto 20px ;
				display: block;
			}
			.input-group input{
				height: 40px ;
				font-size:18px ;
			}
			.yzm{
				padding: 0;
				border: none;
			}
			.yzm img{
				width: 120px;
				height: 39px;
				border: none;
				
			}
			.remember label{
				margin-left: 15px;
				font-weight: normal;
			}
			.bjui-maskProgress{
				z-index: 10 !important;
			}
		</style>
		
		<script type="text/javascript">
			
		
		function updateLogin(data) {
			try {
				if(!isNull(data.content)){
                    console.log(data);
					var tempP = data.content.powerinfo;
					var username = data.content.username;
					//法人架构和权限信息存储
					setStorage(SERVICE_NAME_DATA_TEMP,JSON.stringify(tempP)); 
					if(SERVICE_NAME_DATA == 0){
						//用户名存储
						setStorage(USER_NAME, data.content.name);
						//账号存储
						setStorage(OAACCOUNT, username);
					} if(SERVICE_NAME_DATA == 1){
						//用户名存储
						setStorage(USER_NAME, data.content.nickname);
						//账号存储
						setStorage(OAACCOUNT, data.content.mobile);
						SERVICE_NAME_DATA = 0;
					}
					
				}
				window.location.href = 'index.html';//正确登录后页面跳转至
			} catch (error) {
				console.log(error);
			}            
		}
		</script>
		
		
	</head>
	<body  onkeydown="keyLogin();">
		
		<!--[if lte IE 7]>
		<style type="text/css">
		#errorie {position: fixed; top: 0; z-index: 100000; height: 30px; background: #FCF8E3;}
		#errorie div {width: 900px; margin: 0 auto; line-height: 30px; color: orange; font-size: 24px; text-align: center;}
		#errorie div a {color: #459f79;font-size: 24px;}
		#errorie div a:hover {text-decoration: underline;}
		</style>
		
		<div id="errorie"><div>您还在使用老掉牙的IE，请升级您的浏览器到 IE8以上版本 <a target="_blank" href="http://windows.microsoft.com/zh-cn/internet-explorer/ie-8-worldwide-languages">点击升级</a>&nbsp;&nbsp;强烈建议您更改换浏览器：<a href="http://down.tech.sina.com.cn/content/40975.html" target="_blank">谷歌 Chrome</a></div></div>
		<![endif]-->
		<div class="container">
			<div class="main">
				<p class="center-block logo" style="padding-top: 20px;"><img src="img/logo.png"/></p>
				<form  method="get" id="login" data-toggle="login">
					<div class="form-group" >
							<div class="input-group" style="width:75%; margin: auto;">
    							<input type="text" name="username" class="form-control" id="user" placeholder="请输入OA账号"  style="height: 35px; font-size: 12px; line-height: 1.5; padding: 4px 7px; border-radius: 6px;">
  							</div>
					</div>
					<div class="form-group">
						<div class="input-group" style="width:75%; margin: auto;">
							<input type="password" name="password" class="form-control" id="pass" placeholder="密码" minlength=""  style="height: 35px; font-size: 12px; line-height: 1.5; padding: 4px 7px; border-radius: 6px;">
						</div>
					</div>
					<div class="text-center" style="padding-top: 10px;">
						<a href="#" id="input1" class="btn btn-primary btn-lg" onclick="javascript:doLogin();">登 &nbsp;录</a>&nbsp;&nbsp;&nbsp;&nbsp;
						<button type="reset" class="btn btn-lg">重  &nbsp;置</button>
					</div>
					<a href="javascript:;" class="colorful-cloud" onclick="doCzy();">彩之云账号登录</a>
				</form>
			</div>	
		</div>
		
		<script type="text/javascript">
			
			//点击回车键触发登录事件
			function keyLogin(){
		 		if (event.keyCode == "13") {//keyCode=13是回车键
		 			//获取登录按钮的id，并添加点击事件
					document.getElementById("input1").click();
					var myform = document.getElementById("login");
				    if(checkname()&&checkpwd()){
				    	interfaceServer.doLogin(myform);
				    }
					
		 		}
			}
			
			//点击登录按钮触发登录事件
			function doLogin(){
				var myform = document.getElementById("login");
				if(checkname()&&checkpwd()){
					interfaceServer.doLogin(myform);
				}
			}
			
			//验证账号
			function checkname(){
				var name = document.getElementById("user").value;
				if(name == '' || name == undefined){
					document.getElementById("user").style.borderColor="#ff0000";
					return false;
				}else{
					return true;
				}	
			}
			
			//验证密码
			function checkpwd(){
			    var password=document.getElementById("pass").value;
			    if( password=='' ){
			    	document.getElementById("pass").style.borderColor="#ff0000";
			    	return false;
			  	} else {
			    	return true;
			  	}
			}
			
			
			//彩之云账号登录授权
			function doCzy(){
				interfaceServer.doCzyAuthor();
			}
			
			//彩之云账号登录授权返回
			function upCzyAuthor(data){
				console.log(data);
				window.location.href = data.content;//正确登录后页面跳转至
			}
			
			$(document).ready(function(){
				GetRequest();
			});
			function GetRequest() {
			    var url = location.search; //获取url中"?"符后的字串
			    if(isNull(url)){
			    	return;
			    }
			    var theRequest = new Object();
			    if (url.indexOf("?") != -1) {
			        var str = url.substr(1);
			        strs = str.split("&");
			        for(var i = 0; i < strs.length; i ++) {
			            theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
			        }
			    }
			    var Request = new Object();
				Request = theRequest;
				if (!isNull(Request.state)) {
					var code = Request.code;
					var state = Request.state;
					interfaceServer.doCzyLogin(code,state);
					SERVICE_NAME_DATA ++;
				} else{
					return;
				}
			}
		</script>
	</body>
</html>
